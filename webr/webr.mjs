var e,t=Object.create,r=Object.defineProperty,i=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,s=Object.getPrototypeOf,a=Object.prototype.hasOwnProperty,o=(e=function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')},typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):e),l=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),h=(e,o,l)=>(l=null!=e?t(s(e)):{},((e,t,s,o)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let l of n(t))!a.call(e,l)&&l!==s&&r(e,l,{get:()=>t[l],enumerable:!(o=i(t,l))||o.enumerable});return e})(!o&&e&&e.__esModule?l:r(l,"default",{value:e,enumerable:!0}),e)),u=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},c=(e,t,r)=>(u(e,t,"read from private field"),r?r.call(e):t.get(e)),d=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},p=(e,t,r,i)=>(u(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r),f=(e,t,r)=>(u(e,t,"access private method"),r),y=l(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getUint64=e.getInt64=e.setInt64=e.setUint64=e.UINT32_MAX=void 0,e.UINT32_MAX=4294967295,e.setUint64=function(e,t,r){let i=r/4294967296,n=r;e.setUint32(t,i),e.setUint32(t+4,n)},e.setInt64=function(e,t,r){let i=Math.floor(r/4294967296),n=r;e.setUint32(t,i),e.setUint32(t+4,n)},e.getInt64=function(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)},e.getUint64=function(e,t){return 4294967296*e.getUint32(t)+e.getUint32(t+4)}}),w=l(e=>{var t,r,i;Object.defineProperty(e,"__esModule",{value:!0}),e.utf8DecodeTD=e.TEXT_DECODER_THRESHOLD=e.utf8DecodeJs=e.utf8EncodeTE=e.TEXT_ENCODER_THRESHOLD=e.utf8EncodeJs=e.utf8Count=void 0;var n=y(),s=(typeof process>"u"||"never"!==(null===(t=null==process?void 0:process.env)||void 0===t?void 0:t.TEXT_ENCODING))&&typeof TextEncoder<"u"&&typeof TextDecoder<"u";e.utf8Count=function(e){let t=e.length,r=0,i=0;for(;i<t;){let n=e.charCodeAt(i++);if(4294967168&n)if(4294965248&n){if(n>=55296&&n<=56319&&i<t){let t=e.charCodeAt(i);56320===(64512&t)&&(++i,n=((1023&n)<<10)+(1023&t)+65536)}r+=4294901760&n?4:3}else r+=2;else r++}return r},e.utf8EncodeJs=function(e,t,r){let i=e.length,n=r,s=0;for(;s<i;){let r=e.charCodeAt(s++);if(4294967168&r){if(4294965248&r){if(r>=55296&&r<=56319&&s<i){let t=e.charCodeAt(s);56320===(64512&t)&&(++s,r=((1023&r)<<10)+(1023&t)+65536)}4294901760&r?(t[n++]=r>>18&7|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128):(t[n++]=r>>12&15|224,t[n++]=r>>6&63|128)}else t[n++]=r>>6&31|192;t[n++]=63&r|128}else t[n++]=r}};var a=s?new TextEncoder:void 0;e.TEXT_ENCODER_THRESHOLD=s?typeof process<"u"&&"force"!==(null===(r=null==process?void 0:process.env)||void 0===r?void 0:r.TEXT_ENCODING)?200:0:n.UINT32_MAX,e.utf8EncodeTE=null!=a&&a.encodeInto?function(e,t,r){a.encodeInto(e,t.subarray(r))}:function(e,t,r){t.set(a.encode(e),r)};e.utf8DecodeJs=function(e,t,r){let i=t,n=i+r,s=[],a="";for(;i<n;){let t=e[i++];if(128&t)if(192===(224&t)){let r=63&e[i++];s.push((31&t)<<6|r)}else if(224===(240&t)){let r=63&e[i++],n=63&e[i++];s.push((31&t)<<12|r<<6|n)}else if(240===(248&t)){let r=(7&t)<<18|(63&e[i++])<<12|(63&e[i++])<<6|63&e[i++];r>65535&&(r-=65536,s.push(r>>>10&1023|55296),r=56320|1023&r),s.push(r)}else s.push(t);else s.push(t);s.length>=4096&&(a+=String.fromCharCode(...s),s.length=0)}return s.length>0&&(a+=String.fromCharCode(...s)),a};var o=s?new TextDecoder:null;e.TEXT_DECODER_THRESHOLD=s?typeof process<"u"&&"force"!==(null===(i=null==process?void 0:process.env)||void 0===i?void 0:i.TEXT_DECODER)?200:0:n.UINT32_MAX,e.utf8DecodeTD=function(e,t,r){let i=e.subarray(t,t+r);return o.decode(i)}}),m=l(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ExtData=void 0;e.ExtData=class{constructor(e,t){this.type=e,this.data=t}}}),g=l(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DecodeError=void 0;var t=class extends Error{constructor(e){super(e);let r=Object.create(t.prototype);Object.setPrototypeOf(this,r),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:t.name})}};e.DecodeError=t}),b=l(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.timestampExtension=e.decodeTimestampExtension=e.decodeTimestampToTimeSpec=e.encodeTimestampExtension=e.encodeDateToTimeSpec=e.encodeTimeSpecToTimestamp=e.EXT_TIMESTAMP=void 0;var t=g(),r=y();e.EXT_TIMESTAMP=-1;function i({sec:e,nsec:t}){if(e>=0&&t>=0&&e<=17179869183){if(0===t&&e<=4294967295){let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e),t}{let r=e/4294967296,i=4294967295&e,n=new Uint8Array(8),s=new DataView(n.buffer);return s.setUint32(0,t<<2|3&r),s.setUint32(4,i),n}}{let i=new Uint8Array(12),n=new DataView(i.buffer);return n.setUint32(0,t),(0,r.setInt64)(n,4,e),i}}function n(e){let t=e.getTime(),r=Math.floor(t/1e3),i=1e6*(t-1e3*r),n=Math.floor(i/1e9);return{sec:r+n,nsec:i-1e9*n}}function s(e){if(e instanceof Date){return i(n(e))}return null}function a(e){let i=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:i.getUint32(0),nsec:0};case 8:{let e=i.getUint32(0);return{sec:4294967296*(3&e)+i.getUint32(4),nsec:e>>>2}}case 12:return{sec:(0,r.getInt64)(i,4),nsec:i.getUint32(0)};default:throw new t.DecodeError(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${e.length}`)}}function o(e){let t=a(e);return new Date(1e3*t.sec+t.nsec/1e6)}e.encodeTimeSpecToTimestamp=i,e.encodeDateToTimeSpec=n,e.encodeTimestampExtension=s,e.decodeTimestampToTimeSpec=a,e.decodeTimestampExtension=o,e.timestampExtension={type:e.EXT_TIMESTAMP,encode:s,decode:o}}),v=l(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ExtensionCodec=void 0;var t=m(),r=b(),i=class{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(r.timestampExtension)}register({type:e,encode:t,decode:r}){if(e>=0)this.encoders[e]=t,this.decoders[e]=r;else{let i=1+e;this.builtInEncoders[i]=t,this.builtInDecoders[i]=r}}tryToEncode(e,r){for(let i=0;i<this.builtInEncoders.length;i++){let n=this.builtInEncoders[i];if(null!=n){let s=n(e,r);if(null!=s){let e=-1-i;return new t.ExtData(e,s)}}}for(let i=0;i<this.encoders.length;i++){let n=this.encoders[i];if(null!=n){let s=n(e,r);if(null!=s){let e=i;return new t.ExtData(e,s)}}}return e instanceof t.ExtData?e:null}decode(e,r,i){let n=r<0?this.builtInDecoders[-1-r]:this.decoders[r];return n?n(e,r,i):new t.ExtData(r,e)}};e.ExtensionCodec=i,i.defaultCodec=new i}),E=l(e=>{function t(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Uint8Array.from(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.createDataView=e.ensureUint8Array=void 0,e.ensureUint8Array=t,e.createDataView=function(e){if(e instanceof ArrayBuffer)return new DataView(e);let r=t(e);return new DataView(r.buffer,r.byteOffset,r.byteLength)}}),T=l(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Encoder=e.DEFAULT_INITIAL_BUFFER_SIZE=e.DEFAULT_MAX_DEPTH=void 0;var t=w(),r=v(),i=y(),n=E();e.DEFAULT_MAX_DEPTH=100,e.DEFAULT_INITIAL_BUFFER_SIZE=2048;e.Encoder=class{constructor(t=r.ExtensionCodec.defaultCodec,i=void 0,n=e.DEFAULT_MAX_DEPTH,s=e.DEFAULT_INITIAL_BUFFER_SIZE,a=!1,o=!1,l=!1,h=!1){this.extensionCodec=t,this.context=i,this.maxDepth=n,this.initialBufferSize=s,this.sortKeys=a,this.forceFloat32=o,this.ignoreUndefined=l,this.forceIntegerToFloat=h,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}reinitializeState(){this.pos=0}encodeSharedRef(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}encode(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}doEncode(e,t){if(t>this.maxDepth)throw new Error(`Too deep objects in depth ${t}`);null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.encodeObject(e,t)}ensureBufferSizeToWrite(e){let t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)}resizeBuffer(e){let t=new ArrayBuffer(e),r=new Uint8Array(t),i=new DataView(t);r.set(this.bytes),this.view=i,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){!1===e?this.writeU8(194):this.writeU8(195)}encodeNumber(e){Number.isSafeInteger(e)&&!this.forceIntegerToFloat?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):(this.writeU8(211),this.writeI64(e)):this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error(`Too long string: ${e} bytes in UTF-8`);this.writeU8(219),this.writeU32(e)}}encodeString(e){if(e.length>t.TEXT_ENCODER_THRESHOLD){let r=(0,t.utf8Count)(e);this.ensureBufferSizeToWrite(5+r),this.writeStringHeader(r),(0,t.utf8EncodeTE)(e,this.bytes,this.pos),this.pos+=r}else{let r=(0,t.utf8Count)(e);this.ensureBufferSizeToWrite(5+r),this.writeStringHeader(r),(0,t.utf8EncodeJs)(e,this.bytes,this.pos),this.pos+=r}}encodeObject(e,t){let r=this.extensionCodec.tryToEncode(e,this.context);if(null!=r)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!=typeof e)throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`);this.encodeMap(e,t)}}encodeBinary(e){let t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error(`Too large binary: ${t}`);this.writeU8(198),this.writeU32(t)}let r=(0,n.ensureUint8Array)(e);this.writeU8a(r)}encodeArray(e,t){let r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else{if(!(r<4294967296))throw new Error(`Too large array: ${r}`);this.writeU8(221),this.writeU32(r)}for(let i of e)this.doEncode(i,t+1)}countWithoutUndefined(e,t){let r=0;for(let i of t)void 0!==e[i]&&r++;return r}encodeMap(e,t){let r=Object.keys(e);this.sortKeys&&r.sort();let i=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(i<16)this.writeU8(128+i);else if(i<65536)this.writeU8(222),this.writeU16(i);else{if(!(i<4294967296))throw new Error(`Too large map object: ${i}`);this.writeU8(223),this.writeU32(i)}for(let n of r){let r=e[n];this.ignoreUndefined&&void 0===r||(this.encodeString(n),this.doEncode(r,t+1))}}encodeExtension(e){let t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else{if(!(t<4294967296))throw new Error(`Too large extension object: ${t}`);this.writeU8(201),this.writeU32(t)}this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){let t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),(0,i.setUint64)(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),(0,i.setInt64)(this.view,this.pos,e),this.pos+=8}}}),_=l(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.encode=void 0;var t=T(),r={};e.encode=function(e,i=r){return new t.Encoder(i.extensionCodec,i.context,i.maxDepth,i.initialBufferSize,i.sortKeys,i.forceFloat32,i.ignoreUndefined,i.forceIntegerToFloat).encodeSharedRef(e)}}),x=l(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.prettyByte=void 0,e.prettyByte=function(e){return`${e<0?"-":""}0x${Math.abs(e).toString(16).padStart(2,"0")}`}}),S=l(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CachedKeyDecoder=void 0;var t=w();e.CachedKeyDecoder=class{constructor(e=16,t=16){this.maxKeyLength=e,this.maxLengthPerKey=t,this.hit=0,this.miss=0,this.caches=[];for(let r=0;r<this.maxKeyLength;r++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,t,r){let i=this.caches[r-1];e:for(let n of i){let i=n.bytes;for(let n=0;n<r;n++)if(i[n]!==e[t+n])continue e;return n.str}return null}store(e,t){let r=this.caches[e.length-1],i={bytes:e,str:t};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=i:r.push(i)}decode(e,r,i){let n=this.find(e,r,i);if(null!=n)return this.hit++,n;this.miss++;let s=(0,t.utf8DecodeJs)(e,r,i),a=Uint8Array.prototype.slice.call(e,r,r+i);return this.store(a,s),s}}}),R=l(t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Decoder=t.DataViewIndexOutOfBoundsError=void 0;var r=x(),i=v(),n=y(),s=w(),a=E(),o=S(),l=g(),h=e=>{let t=typeof e;return"string"===t||"number"===t},u=new DataView(new ArrayBuffer(0)),c=new Uint8Array(u.buffer);t.DataViewIndexOutOfBoundsError=(()=>{try{u.getInt8(0)}catch(e){return e.constructor}throw new Error("never reached")})();var d=new t.DataViewIndexOutOfBoundsError("Insufficient data"),p=new o.CachedKeyDecoder;t.Decoder=class{constructor(e=i.ExtensionCodec.defaultCodec,t=void 0,r=n.UINT32_MAX,s=n.UINT32_MAX,a=n.UINT32_MAX,o=n.UINT32_MAX,l=n.UINT32_MAX,h=p){this.extensionCodec=e,this.context=t,this.maxStrLength=r,this.maxBinLength=s,this.maxArrayLength=a,this.maxMapLength=o,this.maxExtLength=l,this.keyDecoder=h,this.totalPos=0,this.pos=0,this.view=u,this.bytes=c,this.headByte=-1,this.stack=[]}reinitializeState(){this.totalPos=0,this.headByte=-1,this.stack.length=0}setBuffer(e){this.bytes=(0,a.ensureUint8Array)(e),this.view=(0,a.createDataView)(this.bytes),this.pos=0}appendBuffer(e){if(-1!==this.headByte||this.hasRemaining(1)){let t=this.bytes.subarray(this.pos),r=(0,a.ensureUint8Array)(e),i=new Uint8Array(t.length+r.length);i.set(t),i.set(r,t.length),this.setBuffer(i)}else this.setBuffer(e)}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){let{view:t,pos:r}=this;return new RangeError(`Extra ${t.byteLength-r} of ${t.byteLength} byte(s) found at buffer[${e}]`)}decode(e){this.reinitializeState(),this.setBuffer(e);let t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t}*decodeMulti(e){for(this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}async decodeAsync(e){let i,n=!1;for await(let r of e){if(n)throw this.createExtraByteError(this.totalPos);this.appendBuffer(r);try{i=this.doDecodeSync(),n=!0}catch(l){if(!(l instanceof t.DataViewIndexOutOfBoundsError))throw l}this.totalPos+=this.pos}if(n){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return i}let{headByte:s,pos:a,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${(0,r.prettyByte)(s)} at ${o} (${a} in the current buffer)`)}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,r){let i=r,n=-1;for await(let a of e){if(r&&0===n)throw this.createExtraByteError(this.totalPos);this.appendBuffer(a),i&&(n=this.readArraySize(),i=!1,this.complete());try{for(;yield this.doDecodeSync(),0!==--n;);}catch(s){if(!(s instanceof t.DataViewIndexOutOfBoundsError))throw s}this.totalPos+=this.pos}}doDecodeSync(){e:for(;;){let e,t=this.readHeadByte();if(t>=224)e=t-256;else if(t<192)if(t<128)e=t;else if(t<144){let r=t-128;if(0!==r){this.pushMapState(r),this.complete();continue e}e={}}else if(t<160){let r=t-144;if(0!==r){this.pushArrayState(r),this.complete();continue e}e=[]}else{let r=t-160;e=this.decodeUtf8String(r,0)}else if(192===t)e=null;else if(194===t)e=!1;else if(195===t)e=!0;else if(202===t)e=this.readF32();else if(203===t)e=this.readF64();else if(204===t)e=this.readU8();else if(205===t)e=this.readU16();else if(206===t)e=this.readU32();else if(207===t)e=this.readU64();else if(208===t)e=this.readI8();else if(209===t)e=this.readI16();else if(210===t)e=this.readI32();else if(211===t)e=this.readI64();else if(217===t){let t=this.lookU8();e=this.decodeUtf8String(t,1)}else if(218===t){let t=this.lookU16();e=this.decodeUtf8String(t,2)}else if(219===t){let t=this.lookU32();e=this.decodeUtf8String(t,4)}else if(220===t){let t=this.readU16();if(0!==t){this.pushArrayState(t),this.complete();continue e}e=[]}else if(221===t){let t=this.readU32();if(0!==t){this.pushArrayState(t),this.complete();continue e}e=[]}else if(222===t){let t=this.readU16();if(0!==t){this.pushMapState(t),this.complete();continue e}e={}}else if(223===t){let t=this.readU32();if(0!==t){this.pushMapState(t),this.complete();continue e}e={}}else if(196===t){let t=this.lookU8();e=this.decodeBinary(t,1)}else if(197===t){let t=this.lookU16();e=this.decodeBinary(t,2)}else if(198===t){let t=this.lookU32();e=this.decodeBinary(t,4)}else if(212===t)e=this.decodeExtension(1,0);else if(213===t)e=this.decodeExtension(2,0);else if(214===t)e=this.decodeExtension(4,0);else if(215===t)e=this.decodeExtension(8,0);else if(216===t)e=this.decodeExtension(16,0);else if(199===t){let t=this.lookU8();e=this.decodeExtension(t,1)}else if(200===t){let t=this.lookU16();e=this.decodeExtension(t,2)}else{if(201!==t)throw new l.DecodeError(`Unrecognized type byte: ${(0,r.prettyByte)(t)}`);{let t=this.lookU32();e=this.decodeExtension(t,4)}}this.complete();let i=this.stack;for(;i.length>0;){let t=i[i.length-1];if(0===t.type){if(t.array[t.position]=e,t.position++,t.position!==t.size)continue e;i.pop(),e=t.array}else{if(1===t.type){if(!h(e))throw new l.DecodeError("The type of key must be string or number but "+typeof e);if("__proto__"===e)throw new l.DecodeError("The key __proto__ is not allowed");t.key=e,t.type=2;continue e}if(t.map[t.key]=e,t.readCount++,t.readCount!==t.size){t.key=null,t.type=1;continue e}i.pop(),e=t.map}}return e}}readHeadByte(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=-1}readArraySize(){let e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new l.DecodeError(`Unrecognized array type byte: ${(0,r.prettyByte)(e)}`)}}pushMapState(e){if(e>this.maxMapLength)throw new l.DecodeError(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.push({type:1,size:e,key:null,readCount:0,map:{}})}pushArrayState(e){if(e>this.maxArrayLength)throw new l.DecodeError(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.push({type:0,size:e,array:new Array(e),position:0})}decodeUtf8String(e,t){var r;if(e>this.maxStrLength)throw new l.DecodeError(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+t+e)throw d;let i,n=this.pos+t;return i=this.stateIsMapKey()&&null!==(r=this.keyDecoder)&&void 0!==r&&r.canBeCached(e)?this.keyDecoder.decode(this.bytes,n,e):e>s.TEXT_DECODER_THRESHOLD?(0,s.utf8DecodeTD)(this.bytes,n,e):(0,s.utf8DecodeJs)(this.bytes,n,e),this.pos+=t+e,i}stateIsMapKey(){return this.stack.length>0&&1===this.stack[this.stack.length-1].type}decodeBinary(e,t){if(e>this.maxBinLength)throw new l.DecodeError(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+t))throw d;let r=this.pos+t,i=this.bytes.subarray(r,r+e);return this.pos+=t+e,i}decodeExtension(e,t){if(e>this.maxExtLength)throw new l.DecodeError(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);let r=this.view.getInt8(this.pos+t),i=this.decodeBinary(e,t+1);return this.extensionCodec.decode(i,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){let e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){let e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){let e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){let e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){let e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){let e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){let e=(0,n.getUint64)(this.view,this.pos);return this.pos+=8,e}readI64(){let e=(0,n.getInt64)(this.view,this.pos);return this.pos+=8,e}readF32(){let e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){let e=this.view.getFloat64(this.pos);return this.pos+=8,e}}}),A=l(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.decodeMulti=e.decode=e.defaultDecodeOptions=void 0;var t=R();e.defaultDecodeOptions={},e.decode=function(r,i=e.defaultDecodeOptions){return new t.Decoder(i.extensionCodec,i.context,i.maxStrLength,i.maxBinLength,i.maxArrayLength,i.maxMapLength,i.maxExtLength).decode(r)},e.decodeMulti=function(r,i=e.defaultDecodeOptions){return new t.Decoder(i.extensionCodec,i.context,i.maxStrLength,i.maxBinLength,i.maxArrayLength,i.maxMapLength,i.maxExtLength).decodeMulti(r)}}),U=l(e=>{function t(e){return null!=e[Symbol.asyncIterator]}function r(e){if(null==e)throw new Error("Assertion Failure: value must not be null nor undefined")}async function*i(e){let t=e.getReader();try{for(;;){let{done:e,value:i}=await t.read();if(e)return;r(i),yield i}}finally{t.releaseLock()}}Object.defineProperty(e,"__esModule",{value:!0}),e.ensureAsyncIterable=e.asyncIterableFromStream=e.isAsyncIterable=void 0,e.isAsyncIterable=t,e.asyncIterableFromStream=i,e.ensureAsyncIterable=function(e){return t(e)?e:i(e)}}),j=l(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.decodeStream=e.decodeMultiStream=e.decodeArrayStream=e.decodeAsync=void 0;var t=R(),r=U(),i=A();function n(e,n=i.defaultDecodeOptions){let s=(0,r.ensureAsyncIterable)(e);return new t.Decoder(n.extensionCodec,n.context,n.maxStrLength,n.maxBinLength,n.maxArrayLength,n.maxMapLength,n.maxExtLength).decodeStream(s)}e.decodeAsync=async function(e,n=i.defaultDecodeOptions){let s=(0,r.ensureAsyncIterable)(e);return new t.Decoder(n.extensionCodec,n.context,n.maxStrLength,n.maxBinLength,n.maxArrayLength,n.maxMapLength,n.maxExtLength).decodeAsync(s)},e.decodeArrayStream=function(e,n=i.defaultDecodeOptions){let s=(0,r.ensureAsyncIterable)(e);return new t.Decoder(n.extensionCodec,n.context,n.maxStrLength,n.maxBinLength,n.maxArrayLength,n.maxMapLength,n.maxExtLength).decodeArrayStream(s)},e.decodeMultiStream=n,e.decodeStream=function(e,t=i.defaultDecodeOptions){return n(e,t)}}),k=l(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.decodeTimestampExtension=e.encodeTimestampExtension=e.decodeTimestampToTimeSpec=e.encodeTimeSpecToTimestamp=e.encodeDateToTimeSpec=e.EXT_TIMESTAMP=e.ExtData=e.ExtensionCodec=e.Encoder=e.DataViewIndexOutOfBoundsError=e.DecodeError=e.Decoder=e.decodeStream=e.decodeMultiStream=e.decodeArrayStream=e.decodeAsync=e.decodeMulti=e.decode=e.encode=void 0;var t=_();Object.defineProperty(e,"encode",{enumerable:!0,get:function(){return t.encode}});var r=A();Object.defineProperty(e,"decode",{enumerable:!0,get:function(){return r.decode}}),Object.defineProperty(e,"decodeMulti",{enumerable:!0,get:function(){return r.decodeMulti}});var i=j();Object.defineProperty(e,"decodeAsync",{enumerable:!0,get:function(){return i.decodeAsync}}),Object.defineProperty(e,"decodeArrayStream",{enumerable:!0,get:function(){return i.decodeArrayStream}}),Object.defineProperty(e,"decodeMultiStream",{enumerable:!0,get:function(){return i.decodeMultiStream}}),Object.defineProperty(e,"decodeStream",{enumerable:!0,get:function(){return i.decodeStream}});var n=R();Object.defineProperty(e,"Decoder",{enumerable:!0,get:function(){return n.Decoder}}),Object.defineProperty(e,"DataViewIndexOutOfBoundsError",{enumerable:!0,get:function(){return n.DataViewIndexOutOfBoundsError}});var s=g();Object.defineProperty(e,"DecodeError",{enumerable:!0,get:function(){return s.DecodeError}});var a=T();Object.defineProperty(e,"Encoder",{enumerable:!0,get:function(){return a.Encoder}});var o=v();Object.defineProperty(e,"ExtensionCodec",{enumerable:!0,get:function(){return o.ExtensionCodec}});var l=m();Object.defineProperty(e,"ExtData",{enumerable:!0,get:function(){return l.ExtData}});var h=b();Object.defineProperty(e,"EXT_TIMESTAMP",{enumerable:!0,get:function(){return h.EXT_TIMESTAMP}}),Object.defineProperty(e,"encodeDateToTimeSpec",{enumerable:!0,get:function(){return h.encodeDateToTimeSpec}}),Object.defineProperty(e,"encodeTimeSpecToTimestamp",{enumerable:!0,get:function(){return h.encodeTimeSpecToTimestamp}}),Object.defineProperty(e,"decodeTimestampToTimeSpec",{enumerable:!0,get:function(){return h.decodeTimestampToTimeSpec}}),Object.defineProperty(e,"encodeTimestampExtension",{enumerable:!0,get:function(){return h.encodeTimestampExtension}}),Object.defineProperty(e,"decodeTimestampExtension",{enumerable:!0,get:function(){return h.decodeTimestampExtension}})}),O=class extends Error{constructor(e){super(e),this.name=this.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}},M=class extends O{},D=class extends O{},I=class extends O{},L=typeof process<"u"&&process.release&&"node"===process.release.name;if(globalThis.document)0;else if(globalThis.importScripts)0;else{if(!L)throw new O("Cannot determine runtime environment");0}function P(){let e={resolve:e=>{},reject:e=>{},promise:null},t=new Promise((t,r)=>{e.resolve=t,e.reject=r});return e.promise=t,e}function C(e){return new Promise(t=>setTimeout(t,e))}function B(e,t,r,...i){return null===e||"object"!=typeof e?e:t(e)?r(e,...i):Array.isArray(e)||ArrayBuffer.isView(e)?e.map(e=>B(e,t,r,...i)):Object.fromEntries(Object.entries(e).map(([e,n],s)=>[e,B(n,t,r,...i)]))}function W(e,t){let r=new XMLHttpRequest;r.open("get",e,!0),r.onload=()=>{let e=new Worker(URL.createObjectURL(new Blob([r.responseText])));t(e)},r.send()}function N(e){if(L)return!1;let t=new URL(location.href),r=new URL(e,location.origin);return!(t.host===r.host&&t.port===r.port&&t.protocol===r.protocol)}var F=new WeakMap;function V(){let e=Array.from({length:4},q).join("-");if(63!==e.length)throw new Error("comlink internal error: UUID has the wrong length");return e}function q(){let e=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16),t=15-e.length;return t>0&&(e=Array.from({length:t},()=>0).join("")+e),e}var z=h(k()),$=new TextEncoder;async function J(e,t,r){try{let{taskId:i,sizeBuffer:n,dataBuffer:s,signalBuffer:a}=t,o=(0,z.encode)(r),l=o.length<=s.length;if(Atomics.store(n,0,o.length),Atomics.store(n,1,+l),!l){let[t,r]=function(e){let t=V();return[t,new Promise(r=>{L?e.once("message",e=>{!e.id||e.id!==t||r(e)}):e.addEventListener("message",function i(n){!n.data||!n.data.id||n.data.id!==t||(e.removeEventListener("message",i),r(n.data))}),e.start&&e.start()})]}(e);s.set($.encode(t)),await H(a,i),s=(await r).dataBuffer}s.set(o),Atomics.store(n,1,1),await H(a,i)}catch(i){console.warn(i)}}async function H(e,t){let r=(t>>1)%32,i=1;for(;0!==Atomics.compareExchange(e,r+1,0,t);)await C(i),i<32&&(i*=2);Atomics.or(e,0,1<<r),Atomics.notify(e,0)}var X,K,G,Q,Y=class{constructor(){d(this,G),d(this,X,void 0),d(this,K,void 0),p(this,K,[]),p(this,X,[])}reset(){p(this,K,[]),p(this,X,[])}put(e){c(this,K).length||f(this,G,Q).call(this),c(this,K).shift()(e)}async get(){return c(this,X).length||f(this,G,Q).call(this),c(this,X).shift()}isEmpty(){return!c(this,X).length}isBlocked(){return!!c(this,K).length}get length(){return c(this,X).length-c(this,K).length}};function Z(e,t){return te({type:"request",data:{uuid:V(),msg:e}},t)}function ee(e,t,r){return te({type:"response",data:{uuid:e,resp:t}},r)}function te(e,t){return t&&function(e,t){F.set(e,t)}(e,t),e}function re(e){return function(e){return e&&"object"==typeof e&&"payloadType"in e&&"obj"in e}(e)&&"ptr"===e.payloadType}X=new WeakMap,K=new WeakMap,G=new WeakSet,Q=function(){c(this,X).push(new Promise(e=>{c(this,K).push(e)}))};var ie,ne=class{constructor(){this.inputQueue=new Y,this.outputQueue=new Y,this.systemQueue=new Y,d(this,ie,new Map)}async read(){return await this.outputQueue.get()}async flush(){let e=[];for(;!this.outputQueue.isEmpty();)e.push(await this.read());return e}async readSystem(){return await this.systemQueue.get()}write(e){this.inputQueue.put(e)}async request(e,t){let r=Z(e,t),{resolve:i,reject:n,promise:s}=P();return c(this,ie).set(r.data.uuid,{resolve:i,reject:n}),this.write(r),s}putClosedMessage(){this.outputQueue.put({type:"closed"})}resolveResponse(e){let t=e.data.uuid,r=c(this,ie).get(t);if(r){let i=e.data.resp;c(this,ie).delete(t),"err"===i.payloadType?r.reject(function(e){let t=new M(e.obj.message);return"Error"!==e.obj.name&&(t.name=e.obj.name),t.stack=e.obj.stack,t}(i)):r.resolve(i)}else console.warn("Can't find request.")}};ie=new WeakMap;h(k()),new TextDecoder("utf-8");new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap;new Int32Array(new ArrayBuffer(4));var se={};L&&(globalThis.Worker=o("worker_threads").Worker);var ae,oe,le,he,ue=class extends ne{constructor(e){super(),d(this,oe),d(this,ae,void 0),this.close=()=>{},d(this,he,async(e,t)=>{if(t&&t.type)switch(t.type){case"resolve":return p(this,ae,new Int32Array(t.data)),void this.resolve();case"response":return void this.resolveResponse(t);case"system":return void this.systemQueue.put(t.data);default:return void this.outputQueue.put(t);case"sync-request":{let r=t,i=r.data.msg,n=r.data.reqData;switch(i.type){case"read":{let t=await this.inputQueue.get();await J(e,n,t);break}default:throw new D(`Unsupported request type '${i.type}'.`)}return}case"request":throw new D("Can't send messages of type 'request' from a worker. Please Use 'sync-request' instead.")}});let t=t=>{f(this,oe,le).call(this,t),this.close=()=>{t.terminate(),this.putClosedMessage()};let r={type:"init",data:{config:e,channelType:Te.SharedArrayBuffer}};t.postMessage(r)};if(N(e.baseUrl))W(`${e.baseUrl}webr-worker.js`,e=>t(e));else{let r=new Worker(`${e.baseUrl}webr-worker.js`);t(r)}({resolve:this.resolve,promise:this.initialised}=P())}interrupt(){if(!c(this,ae))throw new D("Failed attempt to interrupt before initialising interruptBuffer");this.inputQueue.reset(),c(this,ae)[0]=1}};ae=new WeakMap,oe=new WeakSet,le=function(e){L?e.on("message",t=>{c(this,he).call(this,e,t)}):e.onmessage=t=>c(this,he).call(this,e,t.data)},he=new WeakMap;new WeakMap,new WeakMap,new WeakMap,new WeakMap;h(k());L&&(globalThis.Worker=o("worker_threads").Worker);var ce,de,pe,fe,ye,we,me,ge,be,ve,Ee=class extends ne{constructor(e){super(),d(this,fe),d(this,we),d(this,ge),this.close=()=>{},d(this,ce,new Map),d(this,de,void 0),d(this,pe,!1),d(this,ve,async(e,t)=>{if(t&&t.type)switch(t.type){case"resolve":return void this.resolve();case"response":return void this.resolveResponse(t);case"system":return void this.systemQueue.put(t.data);default:return void this.outputQueue.put(t);case"sync-request":{let e=t.data;return void c(this,ce).set(e.data.uuid,e.data.msg)}case"request":throw new D("Can't send messages of type 'request' from a worker.Use service worker fetch request instead.")}});let t=t=>{f(this,ge,be).call(this,t),this.close=()=>{t.terminate(),this.putClosedMessage()},f(this,fe,ye).call(this,`${e.serviceWorkerUrl}webr-serviceworker.js`).then(r=>{let i={type:"init",data:{config:e,channelType:Te.ServiceWorker,clientId:r,location:window.location.href}};t.postMessage(i)})};if(N(e.serviceWorkerUrl))W(`${e.serviceWorkerUrl}webr-worker.js`,e=>t(e));else{let r=new Worker(`${e.serviceWorkerUrl}webr-worker.js`);t(r)}({resolve:this.resolve,promise:this.initialised}=P())}activeRegistration(){var e;if(null==(e=c(this,de))||!e.active)throw new D("Attempted to obtain a non-existent active registration.");return c(this,de).active}interrupt(){p(this,pe,!0)}};ce=new WeakMap,de=new WeakMap,pe=new WeakMap,fe=new WeakSet,ye=async function(e){p(this,de,await navigator.serviceWorker.register(e)),await navigator.serviceWorker.ready,window.addEventListener("beforeunload",()=>{var e;null==(e=c(this,de))||e.unregister()});let t=await new Promise(e=>{navigator.serviceWorker.addEventListener("message",function t(r){"registration-successful"===r.data.type&&(navigator.serviceWorker.removeEventListener("message",t),e(r.data.clientId))}),this.activeRegistration().postMessage({type:"register-client-main"})});return navigator.serviceWorker.addEventListener("message",e=>{f(this,we,me).call(this,e)}),t},we=new WeakSet,me=async function(e){if("request"===e.data.type){let t=e.data.data,r=c(this,ce).get(t);if(!r)throw new D("Request not found during service worker XHR request");switch(c(this,ce).delete(t),r.type){case"read":{let e=await this.inputQueue.get();this.activeRegistration().postMessage({type:"wasm-webr-fetch-response",uuid:t,response:ee(t,e)});break}case"interrupt":{let e=c(this,pe);this.activeRegistration().postMessage({type:"wasm-webr-fetch-response",uuid:t,response:ee(t,e)}),this.inputQueue.reset(),p(this,pe,!1);break}default:throw new D(`Unsupported request type '${r.type}'.`)}return}},ge=new WeakSet,be=function(e){L?e.on("message",t=>{c(this,ve).call(this,e,t)}):e.onmessage=t=>c(this,ve).call(this,e,t.data)},ve=new WeakMap;new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap;var Te={Automatic:0,SharedArrayBuffer:1,ServiceWorker:2};var _e=L?__dirname+"/":"./";function xe(e){return e&&("object"==typeof e||"function"==typeof e)&&"payloadType"in e&&re(e._payload)}function Se(e){return xe(e)&&"null"===e._payload.obj.type}function Re(e){return xe(e)&&"symbol"===e._payload.obj.type}function Ae(e){return xe(e)&&"pairlist"===e._payload.obj.type}function Ue(e){return xe(e)&&"environment"===e._payload.obj.type}function je(e){return xe(e)&&"logical"===e._payload.obj.type}function ke(e){return xe(e)&&"integer"===e._payload.obj.type}function Oe(e){return xe(e)&&"double"===e._payload.obj.type}function Me(e){return xe(e)&&"complex"===e._payload.obj.type}function De(e){return xe(e)&&"character"===e._payload.obj.type}function Ie(e){return xe(e)&&"list"===e._payload.obj.type}function Le(e){return xe(e)&&"raw"===e._payload.obj.type}function Pe(e){return xe(e)&&"call"===e._payload.obj.type}function Ce(e){var t;return!(!xe(e)||null==(t=e._payload.obj.methods)||!t.includes("exec"))}var Be={null:0,symbol:1,pairlist:2,closure:3,environment:4,promise:5,call:6,special:7,builtin:8,string:9,logical:10,integer:13,double:14,complex:15,character:16,dots:17,any:18,list:19,expression:20,bytecode:21,pointer:22,weakref:23,raw:24,s4:25,new:30,free:31,function:99};function We(e){return e&&"object"==typeof e&&Object.keys(Be).includes(e.type)}function Ne(e){return e&&"object"==typeof e&&"re"in e&&"im"in e}function Fe(e){return se._Rf_protect(He(e)),e}function Ve(e,t){return se._Rf_protect(He(e)),++t.n,e}function qe(e){se._Rf_unprotect(e)}function ze(e,t,r){se._Rf_defineVar(He(t),He(r),He(e))}function $e(e,t){let r={},i={n:0};try{let n=new ht(t);Ve(n,i),r.code=se.allocateUTF8(e);let s=se._R_ParseEvalString(r.code,n.ptr);return et.wrap(s)}finally{(function(e){Object.keys(e).forEach(t=>se._free(e[t]))})(r),qe(i.n)}}function Je(e,t){return se.getWasmTableEntry(se.GOT.ffi_safe_eval.value)(He(e),He(t))}function He(e){return function(e){return e instanceof et}(e)?e.ptr:e}function Xe(e,t){if(se._TYPEOF(e.ptr)!==Be[t])throw new Error(`Unexpected object type "${e.type()}" when expecting type "${t}"`)}function Ke(e){if(We(e))return new(kt(Be[e.type]))(e);if(e&&"object"==typeof e&&"type"in e&&"null"===e.type)return new rt;if(null===e)return new dt({type:"logical",names:null,values:[null]});if("boolean"==typeof e)return new dt(e);if("number"==typeof e)return new gt(e);if("string"==typeof e)return new xt(e);if(Ne(e))return new Et(e);if(Array.isArray(e))return function(e){let t={n:0};try{let r=new st([new it("c"),...e]);return Ve(r,t),r.eval()}finally{qe(t.n)}}(e);throw new Error("Robj construction for this JS object is not yet supported")}var Ge,Qe,Ye=class{constructor(e){this.ptr=e}type(){let e=se._TYPEOF(this.ptr);return Object.keys(Be).find(t=>Be[t]===e)}},Ze=class extends Ye{constructor(e){if(!(e instanceof Ye))return Ke(e);super(e.ptr),d(this,Ge)}static wrap(e){return new(kt(se._TYPEOF(e)))(new Ye(e))}get[Symbol.toStringTag](){return`RObject:${this.type()}`}static getPersistentObject(e){return Rt[e]}getPropertyValue(e){return this[e]}inspect(){$e(".Internal(inspect(x))",{x:this})}isNull(){return se._TYPEOF(this.ptr)===Be.null}isUnbound(){return this.ptr===Rt.unboundValue.ptr}attrs(){return nt.wrap(se._ATTRIB(this.ptr))}setNames(e){let t;if(null===e)t=Rt.null;else{if(!Array.isArray(e)||!e.every(e=>"string"==typeof e||null===e))throw new Error("Argument to setNames must be null or an Array of strings or null");t=new xt(e)}return se._Rf_setAttrib(this.ptr,Rt.namesSymbol.ptr,t.ptr),this}names(){let e=xt.wrap(se._Rf_getAttrib(this.ptr,Rt.namesSymbol.ptr));return e.isNull()?null:e.toArray()}includes(e){let t=this.names();return t&&t.includes(e)}toJs(e={depth:0},t=1){throw new Error("This R object cannot be converted to JS")}subset(e){return f(this,Ge,Qe).call(this,e,Rt.bracketSymbol.ptr)}get(e){return f(this,Ge,Qe).call(this,e,Rt.bracket2Symbol.ptr)}getDollar(e){return f(this,Ge,Qe).call(this,e,Rt.dollarSymbol.ptr)}pluck(...e){let t=function(e){let t=se._malloc(4);return se._R_ProtectWithIndex(He(e),t),{loc:se.getValue(t,"i32"),ptr:t}}(Rt.null);try{let r=(e,r)=>function(e,t){return se._R_Reprotect(He(e),t.loc),e}(e.get(r),t),i=e.reduce(r,this);return i.isNull()?void 0:i}finally{!function(e){se._Rf_unprotect(1),se._free(e.ptr)}(t)}}set(e,t){let r={n:0};try{let i=new Ze(e);Ve(i,r);let n=new Ze(t);Ve(n,r);let s=new it("[[<-"),a=se._Rf_lang4(s.ptr,this.ptr,i.ptr,n.ptr);return Ve(a,r),Ze.wrap(Je(a,Rt.baseEnv))}finally{qe(r.n)}}static getMethods(e){let t=new Set,r=e;do{Object.getOwnPropertyNames(r).map(e=>t.add(e))}while(r=Object.getPrototypeOf(r));return[...t.keys()].filter(t=>"function"==typeof e[t])}},et=Ze;Ge=new WeakSet,Qe=function(e,t){let r={n:0};try{let i=new Ze(e);Ve(i,r);let n=se._Rf_lang3(t,this.ptr,i.ptr);return Ve(n,r),Ze.wrap(Je(n,Rt.baseEnv))}finally{qe(r.n)}};var tt,rt=class extends et{constructor(){return super(new Ye(se.getValue(se._R_NilValue,"*"))),this}toJs(){return{type:"null"}}},it=class extends et{constructor(e){if(e instanceof Ye)return Xe(e,"symbol"),void super(e);let t=se.allocateUTF8(e);try{super(new Ye(se._Rf_install(t)))}finally{se._free(t)}}toJs(){let e=this.toObject();return{type:"symbol",printname:e.printname,symvalue:e.symvalue,internal:e.internal}}toObject(){return{printname:this.printname().isUnbound()?null:this.printname().toString(),symvalue:this.symvalue().isUnbound()?null:this.symvalue().ptr,internal:this.internal().isNull()?null:this.internal().ptr}}toString(){return this.printname().toString()}printname(){return lt.wrap(se._PRINTNAME(this.ptr))}symvalue(){return et.wrap(se._SYMVALUE(this.ptr))}internal(){return et.wrap(se._INTERNAL(this.ptr))}},nt=class extends et{constructor(e){if(e instanceof Ye)return Xe(e,"pairlist"),super(e),this;let t={n:0};try{let{names:r,values:i}=jt(e),n=nt.wrap(se._Rf_allocList(i.length));Ve(n,t);for(let[e,t]=[0,n];!t.isNull();[e,t]=[e+1,t.cdr()])t.setcar(new et(i[e]));n.setNames(r),super(n)}finally{qe(t.n)}}get length(){return this.toArray().length}toArray(e={depth:1}){return this.toJs(e).values}toObject({allowDuplicateKey:e=!0,allowEmptyKey:t=!1,depth:r=1}={}){let i=this.entries({depth:r}),n=i.map(([e,t])=>e);if(!e&&new Set(n).size!==n.length)throw new Error("Duplicate key when converting pairlist without allowDuplicateKey enabled");if(!t&&n.some(e=>!e))throw new Error("Empty or null key when converting pairlist without allowEmptyKey enabled");return Object.fromEntries(i.filter((e,t)=>i.findIndex(t=>t[0]===e[0])===t))}entries(e={depth:1}){let t=this.toJs(e);return t.values.map((e,r)=>[t.names?t.names[r]:null,e])}toJs(e={depth:0},t=1){let r=[],i=!1,n=[];for(let s=this;!s.isNull();s=s.cdr()){let a=s.tag();a.isNull()?r.push(""):(i=!0,r.push(a.toString())),e.depth&&t>=e.depth?n.push(s.car()):n.push(s.car().toJs(e,t+1))}return{type:"pairlist",names:i?r:null,values:n}}includes(e){return e in this.toObject()}setcar(e){se._SETCAR(this.ptr,e.ptr)}car(){return et.wrap(se._CAR(this.ptr))}cdr(){return et.wrap(se._CDR(this.ptr))}tag(){return et.wrap(se._TAG(this.ptr))}},st=class extends et{constructor(e){if(e instanceof Ye)return Xe(e,"call"),super(e),this;let t={n:0};try{let{values:r}=jt(e),i=r.map(e=>Ve(new et(e),t)),n=st.wrap(se._Rf_allocVector(Be.call,r.length));Ve(n,t);for(let[e,t]=[0,n];!t.isNull();[e,t]=[e+1,t.cdr()])t.setcar(i[e]);super(n)}finally{qe(t.n)}}setcar(e){se._SETCAR(this.ptr,e.ptr)}car(){return et.wrap(se._CAR(this.ptr))}cdr(){return et.wrap(se._CDR(this.ptr))}eval(){return et.wrap(Je(this.ptr,Rt.baseEnv))}},at=class extends et{constructor(e){if(e instanceof Ye)return Xe(e,"list"),super(e),this;let t={n:0};try{let{names:r,values:i}=jt(e),n=se._Rf_allocVector(Be.list,i.length);Ve(n,t),i.forEach((e,t)=>{se._SET_VECTOR_ELT(n,t,new et(e).ptr)}),et.wrap(n).setNames(r),super(new Ye(n))}finally{qe(t.n)}}get length(){return se._LENGTH(this.ptr)}toArray(e={depth:1}){return this.toJs(e).values}toObject({allowDuplicateKey:e=!0,allowEmptyKey:t=!1,depth:r=1}={}){let i=this.entries({depth:r}),n=i.map(([e,t])=>e);if(!e&&new Set(n).size!==n.length)throw new Error("Duplicate key when converting list without allowDuplicateKey enabled");if(!t&&n.some(e=>!e))throw new Error("Empty or null key when converting list without allowEmptyKey enabled");return Object.fromEntries(i.filter((e,t)=>i.findIndex(t=>t[0]===e[0])===t))}entries(e={depth:1}){let t=this.toJs(e);return t.values.map((e,r)=>[t.names?t.names[r]:null,e])}toJs(e={depth:0},t=1){return{type:"list",names:this.names(),values:[...Array(this.length).keys()].map(r=>e.depth&&t>=e.depth?this.get(r+1):this.get(r+1).toJs(e,t+1))}}},ot=class extends et{exec(...e){let t={n:0};try{let r=new st([this,...e]);return Ve(r,t),r.eval()}finally{qe(t.n)}}},lt=class extends et{constructor(e){if(e instanceof Ye)return Xe(e,"string"),void super(e);let t=se.allocateUTF8(e);try{super(new Ye(se._Rf_mkChar(t)))}finally{se._free(t)}}toString(){return se.UTF8ToString(se._R_CHAR(this.ptr))}toJs(){return{type:"string",value:this.toString()}}},ht=class extends et{constructor(e={}){if(e instanceof Ye)return Xe(e,"environment"),super(e),this;let t=0;try{let{names:r,values:i}=jt(e),n=Fe(se._R_NewEnv(Rt.globalEnv.ptr,0,0));++t,i.forEach((e,t)=>{let i=r?r[t]:null;if(!i)throw new Error("Can't create object in new environment with empty symbol name");let s=new it(i),a=Fe(new et(e));try{ze(n,s,a)}finally{qe(1)}}),super(new Ye(n))}finally{qe(t)}}ls(e=!1,t=!0){return xt.wrap(se._R_lsInternal3(this.ptr,Number(e),Number(t))).toArray()}bind(e,t){let r=new it(e),i=Fe(new et(t));try{ze(this,r,i)}finally{qe(1)}}names(){return this.ls(!0,!0)}frame(){return et.wrap(se._FRAME(this.ptr))}subset(e){if("number"==typeof e)throw new Error("Object of type environment is not subsettable");return this.getDollar(e)}toObject({depth:e=0}={}){let t=this.names();return Object.fromEntries([...Array(t.length).keys()].map(r=>[t[r],this.getDollar(t[r]).toJs({depth:e})]))}toJs(e={depth:0},t=1){let r=this.names(),i=[...Array(r.length).keys()].map(i=>e.depth&&t>=e.depth?this.getDollar(r[i]):this.getDollar(r[i]).toJs(e,t+1));return{type:"environment",names:r,values:i}}},ut=class extends et{constructor(e,t,r){if(e instanceof Ye)return Xe(e,t),super(e),this;let i={n:0};try{let{names:n,values:s}=jt(e),a=se._Rf_allocVector(Be[t],s.length);Ve(a,i),s.forEach(r(a)),et.wrap(a).setNames(n),super(new Ye(a))}finally{qe(i.n)}}get length(){return se._LENGTH(this.ptr)}get(e){return super.get(e)}subset(e){return super.subset(e)}getDollar(e){throw new Error("$ operator is invalid for atomic vectors")}detectMissing(){let e={n:0};try{let t=se._Rf_lang2(new it("is.na").ptr,this.ptr);Ve(t,e);let r=dt.wrap(Je(t,Rt.baseEnv));Ve(r,e);let i=r.toTypedArray();return Array.from(i).map(e=>!!e)}finally{qe(e.n)}}toArray(){let e=this.toTypedArray();return this.detectMissing().map((t,r)=>t?null:e[r])}toObject({allowDuplicateKey:e=!0,allowEmptyKey:t=!1}={}){let r=this.entries(),i=r.map(([e,t])=>e);if(!e&&new Set(i).size!==i.length)throw new Error("Duplicate key when converting atomic vector without allowDuplicateKey enabled");if(!t&&i.some(e=>!e))throw new Error("Empty or null key when converting atomic vector without allowEmptyKey enabled");return Object.fromEntries(r.filter((e,t)=>r.findIndex(t=>t[0]===e[0])===t))}entries(){let e=this.toArray(),t=this.names();return e.map((e,r)=>[t?t[r]:null,e])}toJs(){return{type:this.type(),names:this.names(),values:this.toArray()}}},ct=class extends ut{constructor(e){super(e,"logical",c(ct,tt))}getBoolean(e){return this.get(e).toArray()[0]}toBoolean(){if(1!==this.length)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getBoolean(1);if(null===e)throw new Error("Can't convert missing value `NA` to a JS boolean");return e}toTypedArray(){return new Int32Array(se.HEAP32.subarray(se._LOGICAL(this.ptr)/4,se._LOGICAL(this.ptr)/4+this.length))}toArray(){let e=this.toTypedArray();return this.detectMissing().map((t,r)=>t?null:!!e[r])}},dt=ct;tt=new WeakMap,d(dt,tt,e=>{let t=se._LOGICAL(e),r=se.getValue(se._R_NaInt,"i32");return(e,i)=>{se.setValue(t+4*i,null===e?r:!!e,"i32")}});var pt,ft=class extends ut{constructor(e){super(e,"integer",c(ft,pt))}getNumber(e){return this.get(e).toArray()[0]}toNumber(){if(1!==this.length)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getNumber(1);if(null===e)throw new Error("Can't convert missing value `NA` to a JS number");return e}toTypedArray(){return new Int32Array(se.HEAP32.subarray(se._INTEGER(this.ptr)/4,se._INTEGER(this.ptr)/4+this.length))}},yt=ft;pt=new WeakMap,d(yt,pt,e=>{let t=se._INTEGER(e),r=se.getValue(se._R_NaInt,"i32");return(e,i)=>{se.setValue(t+4*i,null===e?r:Math.round(Number(e)),"i32")}});var wt,mt=class extends ut{constructor(e){super(e,"double",c(mt,wt))}getNumber(e){return this.get(e).toArray()[0]}toNumber(){if(1!==this.length)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getNumber(1);if(null===e)throw new Error("Can't convert missing value `NA` to a JS number");return e}toTypedArray(){return new Float64Array(se.HEAPF64.subarray(se._REAL(this.ptr)/8,se._REAL(this.ptr)/8+this.length))}},gt=mt;wt=new WeakMap,d(gt,wt,e=>{let t=se._REAL(e),r=se.getValue(se._R_NaReal,"double");return(e,i)=>{se.setValue(t+8*i,null===e?r:e,"double")}});var bt,vt=class extends ut{constructor(e){super(e,"complex",c(vt,bt))}getComplex(e){return this.get(e).toArray()[0]}toComplex(){if(1!==this.length)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getComplex(1);if(null===e)throw new Error("Can't convert missing value `NA` to a JS object");return e}toTypedArray(){return new Float64Array(se.HEAPF64.subarray(se._COMPLEX(this.ptr)/8,se._COMPLEX(this.ptr)/8+2*this.length))}toArray(){let e=this.toTypedArray();return this.detectMissing().map((t,r)=>t?null:{re:e[2*r],im:e[2*r+1]})}},Et=vt;bt=new WeakMap,d(Et,bt,e=>{let t=se._COMPLEX(e),r=se.getValue(se._R_NaReal,"double");return(e,i)=>{se.setValue(t+2*i*8,null===e?r:e.re,"double"),se.setValue(t+8*(2*i+1),null===e?r:e.im,"double")}});var Tt,_t=class extends ut{constructor(e){super(e,"character",c(_t,Tt))}getString(e){return this.get(e).toArray()[0]}toString(){if(1!==this.length)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getString(1);if(null===e)throw new Error("Can't convert missing value `NA` to a JS string");return e}toTypedArray(){return new Uint32Array(se.HEAPU32.subarray(se._STRING_PTR(this.ptr)/4,se._STRING_PTR(this.ptr)/4+this.length))}toArray(){return this.detectMissing().map((e,t)=>e?null:se.UTF8ToString(se._R_CHAR(se._STRING_ELT(this.ptr,t))))}},xt=_t;Tt=new WeakMap,d(xt,Tt,e=>(t,r)=>{null===t?se._SET_STRING_ELT(e,r,Rt.naString.ptr):se._SET_STRING_ELT(e,r,new lt(t).ptr)});var St,Rt,At=class extends ut{constructor(e){super(e,"raw",c(At,St))}getNumber(e){return this.get(e).toArray()[0]}toNumber(){if(1!==this.length)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getNumber(1);if(null===e)throw new Error("Can't convert missing value `NA` to a JS number");return e}toTypedArray(){return new Uint8Array(se.HEAPU8.subarray(se._RAW(this.ptr),se._RAW(this.ptr)+this.length))}},Ut=At;function jt(e){return We(e)?e:Array.isArray(e)||ArrayBuffer.isView(e)?{names:null,values:e}:e&&"object"==typeof e&&!Ne(e)?{names:Object.keys(e),values:Object.values(e)}:{names:null,values:[e]}}function kt(e){let t={[Be.null]:rt,[Be.symbol]:it,[Be.pairlist]:nt,[Be.closure]:ot,[Be.environment]:ht,[Be.call]:st,[Be.special]:ot,[Be.builtin]:ot,[Be.string]:lt,[Be.logical]:dt,[Be.integer]:yt,[Be.double]:gt,[Be.complex]:Et,[Be.character]:xt,[Be.list]:at,[Be.raw]:Ut,[Be.function]:ot};return e in t?t[e]:et}function Ot(){}function Mt(e,t,r){return async(...i)=>{let n=i.map(e=>xe(e)?e._payload:{obj:B(e,xe,e=>e._payload),payloadType:"raw"}),s={type:"callRObjectMethod",data:{payload:r,prop:t,args:n}},a=await e.request(s);switch(a.payloadType){case"ptr":return Dt(e,a);case"raw":return B(a,re,(e,t)=>Dt(t,e),e).obj}}}function Dt(e,t){var r;let i=new Proxy(null!=(r=t.obj.methods)&&r.includes("exec")?Object.assign(Ot,{...t}):t,{get:(r,n)=>{var s;return"_payload"===n?t:n===Symbol.asyncIterator?function(e,t){return async function*(){let r={type:"callRObjectMethod",data:{payload:t._payload,prop:"getPropertyValue",args:[{payloadType:"raw",obj:"length"}],shelter:void 0}},i=await e.request(r);if("number"!=typeof i.obj)throw new O("Cannot iterate over object, unexpected type for length property.");for(let e=1;e<=i.obj;e++)yield t.get(e)}}(e,i):null!=(s=t.obj.methods)&&s.includes(n.toString())?Mt(e,n.toString(),t):void 0},apply:async(r,i,n)=>{let s=await Dt(e,t).exec(...n);return Ce(s)?s:s.toJs()}});return i}function It(e,t,r){return new Proxy(et,{construct:(i,n)=>async function(e,t,r,i){let n={type:"newRObject",data:{objType:t,obj:B(i,xe,e=>e._payload),shelter:r}},s=await e.request(n);switch(s.payloadType){case"raw":throw new I("Unexpected raw payload type returned from newRObject");case"ptr":return Dt(e,s)}}(e,r,t,...n),get:(t,r)=>Mt(e,r.toString())})}St=new WeakMap,d(Ut,St,e=>{let t=se._RAW(e);return(e,r)=>{se.setValue(t+r,Number(e),"i8")}});var Lt,Pt,Ct,Bt,Wt,Nt,Ft,Vt,qt,zt,$t=class{constructor(e={},t={REnv:{R_HOME:"/usr/lib/R",FONTCONFIG_PATH:"/etc/fonts",R_ENABLE_JIT:"0"}}){d(this,qt),d(this,Lt,void 0),d(this,Pt,void 0),d(this,Ct,void 0),d(this,Bt,void 0),d(this,Wt,e=>{console.log(e)}),d(this,Nt,e=>{console.error(e)}),d(this,Ft,e=>{let t=prompt(e);t&&this.stdin(`${t}\n`)}),d(this,Vt,e=>{if(L)throw new Error("Plotting with HTML canvas is not yet supported under Node");this.canvas.getContext("2d").drawImage(e,0,0)}),this.webR=new Gt(t),L||(this.canvas=document.createElement("canvas"),this.canvas.setAttribute("width","1008"),this.canvas.setAttribute("height","1008")),p(this,Lt,e.stdout||c(this,Wt)),p(this,Pt,e.stderr||c(this,Nt)),p(this,Ct,e.prompt||c(this,Ft)),p(this,Bt,e.canvasImage||c(this,Vt)),this.webR.evalRVoid("options(device=webr::canvas)")}stdin(e){this.webR.writeConsole(e)}interrupt(){this.webR.interrupt()}run(){f(this,qt,zt).call(this)}};Lt=new WeakMap,Pt=new WeakMap,Ct=new WeakMap,Bt=new WeakMap,Wt=new WeakMap,Nt=new WeakMap,Ft=new WeakMap,Vt=new WeakMap,qt=new WeakSet,zt=async function(){for(;;){let e=await this.webR.read();switch(e.type){case"stdout":c(this,Lt).call(this,e.data);break;case"stderr":c(this,Pt).call(this,e.data);break;case"prompt":c(this,Ct).call(this,e.data);break;case"canvasImage":c(this,Bt).call(this,e.data.image);break;case"closed":return;default:console.warn(`Unhandled output type for webR Console: ${e.type}.`)}}};var Jt,Ht,Xt,Kt={RArgs:[],REnv:{FONTCONFIG_PATH:"/etc/fonts",R_HOME:"/usr/lib/R",R_ENABLE_JIT:"0"},baseUrl:_e,serviceWorkerUrl:"",repoUrl:"https://repo.r-wasm.org",homedir:"/home/web_user",interactive:!0,channelType:Te.Automatic,createLazyFilesystem:!0},Gt=class{constructor(e={}){d(this,Ht),d(this,Jt,void 0),this.FS={lookupPath:async e=>{let t={type:"lookupPath",data:{path:e}};return(await c(this,Jt).request(t)).obj},mkdir:async e=>{let t={type:"mkdir",data:{path:e}};return(await c(this,Jt).request(t)).obj},readFile:async(e,t)=>{let r={type:"readFile",data:{path:e,flags:t}};return(await c(this,Jt).request(r)).obj},rmdir:async e=>{let t={type:"rmdir",data:{path:e}};await c(this,Jt).request(t)},writeFile:async(e,t,r)=>{let i={type:"writeFile",data:{path:e,data:t,flags:r}};await c(this,Jt).request(i)},unlink:async e=>{let t={type:"unlink",data:{path:e}};await c(this,Jt).request(t)}};let t={...Kt,...e,REnv:{...Kt.REnv,...e.REnv}};p(this,Jt,function(e){switch(e.channelType){case Te.SharedArrayBuffer:return new ue(e);case Te.ServiceWorker:return new Ee(e);case Te.Automatic:default:if(typeof SharedArrayBuffer<"u")return new ue(e);if("serviceWorker"in navigator&&!N(e.serviceWorkerUrl))return new Ee(e);throw new D("Can't initialise main thread communication channel")}}(t)),this.objs={},this.Shelter=function(e){return new Proxy(er,{construct:async()=>{let t=new er(e);return await t.init(),t}})}(c(this,Jt))}async init(){let e=await c(this,Jt).initialised;return this.globalShelter=await new this.Shelter,this.RObject=this.globalShelter.RObject,this.RLogical=this.globalShelter.RLogical,this.RInteger=this.globalShelter.RInteger,this.RDouble=this.globalShelter.RDouble,this.RComplex=this.globalShelter.RComplex,this.RCharacter=this.globalShelter.RCharacter,this.RRaw=this.globalShelter.RRaw,this.RList=this.globalShelter.RList,this.RPairlist=this.globalShelter.RPairlist,this.REnvironment=this.globalShelter.REnvironment,this.RSymbol=this.globalShelter.RSymbol,this.RString=this.globalShelter.RString,this.RCall=this.globalShelter.RCall,this.objs={baseEnv:await this.RObject.getPersistentObject("baseEnv"),globalEnv:await this.RObject.getPersistentObject("globalEnv"),null:await this.RObject.getPersistentObject("null"),true:await this.RObject.getPersistentObject("true"),false:await this.RObject.getPersistentObject("false"),na:await this.RObject.getPersistentObject("na")},f(this,Ht,Xt).call(this),e}close(){c(this,Jt).close()}async read(){return await c(this,Jt).read()}async flush(){return await c(this,Jt).flush()}write(e){c(this,Jt).write(e)}writeConsole(e){this.write({type:"stdin",data:e+"\n"})}interrupt(){c(this,Jt).interrupt()}async installPackages(e,t=!1){for(let r of e){let e={type:"installPackage",data:{name:r,quiet:t}};await c(this,Jt).request(e)}}async destroy(e){await this.globalShelter.destroy(e)}async evalR(e,t){return this.globalShelter.evalR(e,t)}async evalRVoid(e,t){return this.evalRRaw(e,"void",t)}async evalRBoolean(e,t){return this.evalRRaw(e,"boolean",t)}async evalRNumber(e,t){return this.evalRRaw(e,"number",t)}async evalRString(e,t){return this.evalRRaw(e,"string",t)}async evalRRaw(e,t,r={}){let i={type:"evalRRaw",data:{code:e,options:B(r,xe,e=>e._payload),outputType:t}},n=await c(this,Jt).request(i);switch(n.payloadType){case"raw":return n.obj;case"ptr":throw new I("Unexpected ptr payload type returned from evalRVoid")}}async invokeWasmFunction(e,...t){let r={type:"invokeWasmFunction",data:{ptr:e,args:t}};return(await c(this,Jt).request(r)).obj}};Jt=new WeakMap,Ht=new WeakSet,Xt=async function(){for(;;){let e=await c(this,Jt).readSystem();switch(e.type){case"setTimeoutWasm":setTimeout((e,t)=>{this.invokeWasmFunction(e,...t)},e.data.delay,e.data.ptr,e.data.args);break;case"console.log":console.log(e.data);break;case"console.warn":console.warn(e.data);break;case"console.error":console.error(e.data);break;default:throw new O("Unknown system message type `"+e.type+"`")}}};var Qt,Yt,Zt,er=class{constructor(e){d(this,Qt,""),d(this,Yt,void 0),d(this,Zt,!1),p(this,Yt,e)}async init(){if(c(this,Zt))return;let e=await c(this,Yt).request({type:"newShelter"});p(this,Qt,e.obj),this.RObject=It(c(this,Yt),c(this,Qt),"object"),this.RLogical=It(c(this,Yt),c(this,Qt),"logical"),this.RInteger=It(c(this,Yt),c(this,Qt),"integer"),this.RDouble=It(c(this,Yt),c(this,Qt),"double"),this.RComplex=It(c(this,Yt),c(this,Qt),"complex"),this.RCharacter=It(c(this,Yt),c(this,Qt),"character"),this.RRaw=It(c(this,Yt),c(this,Qt),"raw"),this.RList=It(c(this,Yt),c(this,Qt),"list"),this.RPairlist=It(c(this,Yt),c(this,Qt),"pairlist"),this.REnvironment=It(c(this,Yt),c(this,Qt),"environment"),this.RSymbol=It(c(this,Yt),c(this,Qt),"symbol"),this.RString=It(c(this,Yt),c(this,Qt),"string"),this.RCall=It(c(this,Yt),c(this,Qt),"call"),p(this,Zt,!0)}async purge(){let e={type:"shelterPurge",data:c(this,Qt)};await c(this,Yt).request(e)}async destroy(e){let t={type:"shelterDestroy",data:{id:c(this,Qt),obj:e._payload}};await c(this,Yt).request(t)}async size(){let e={type:"shelterSize",data:c(this,Qt)};return(await c(this,Yt).request(e)).obj}async evalR(e,t={}){let r={type:"evalR",data:{code:e,options:B(t,xe,e=>e._payload),shelter:c(this,Qt)}},i=await c(this,Yt).request(r);if("raw"===i.payloadType)throw new I("Unexpected payload type returned from evalR");return Dt(c(this,Yt),i)}async captureR(e,t={}){let r={type:"captureR",data:{code:e,options:B(t,xe,e=>e._payload),shelter:c(this,Qt)}},i=await c(this,Yt).request(r);switch(i.payloadType){case"ptr":throw new I("Unexpected payload type returned from evalR");case"raw":{let e=i.obj,t=Dt(c(this,Yt),e.result),r=e.output;for(let i=0;i<r.length;++i)"stdout"!==r[i].type&&"stderr"!==r[i].type&&(r[i].data=Dt(c(this,Yt),r[i].data));return{result:t,output:r}}}}};Qt=new WeakMap,Yt=new WeakMap,Zt=new WeakMap;export{$t as Console,er as Shelter,Gt as WebR,D as WebRChannelError,O as WebRError,I as WebRPayloadError,M as WebRWorkerError,Pe as isRCall,De as isRCharacter,Me as isRComplex,Oe as isRDouble,Ue as isREnvironment,Ce as isRFunction,ke as isRInteger,Ie as isRList,je as isRLogical,Se as isRNull,xe as isRObject,Ae as isRPairlist,Le as isRRaw,Re as isRSymbol};